# TaskVision Chrome拡張機能仕様書

## 概要

TaskVision Chrome拡張機能は、ウェブブラウジング中にワンクリックでTaskVisionにタスクを追加できるようにする機能です。ユーザーはウェブページの内容を簡単にタスク化でき、情報源への参照を失うことなく後で処理することができます。

**開発ステータス**: 優先開発中 (2023年Q4)

## 主要機能

1. **ワンクリックタスク作成**
   - ブラウザツールバーのボタンからポップアップを表示
   - 現在のページのタイトルとURLを自動取得
   - タスク名、説明、期限などの基本情報を入力できるフォーム

2. **テキスト選択からのタスク作成**
   - ウェブページ上でテキストを選択し、右クリックメニューから「TaskVisionにタスクとして追加」を選択
   - 選択したテキストが自動的にタスクの説明に含まれる

3. **ショートカットキー対応**
   - タスク作成のためのショートカットキー
   - 各種機能へのキーボードアクセス

4. **Firebase連携**
   - Firebase認証を通じたアカウント連携
   - Firestoreとの直接通信

5. **オフラインサポート**
   - インターネット接続がない場合はローカルにキャッシュし、接続回復後に同期
   - タスクのバッチ処理

## 技術仕様

### アーキテクチャ

本拡張機能は以下のコンポーネントで構成されます：

1. **ポップアップUI**
   - React + TypeScriptで構築
   - TaskVisionと同様のUIコンポーネントを使用（Shadcn UI）
   - 状態管理にはReduxまたはContextを使用

2. **バックグラウンドスクリプト**
   - Firebase認証の管理
   - オフライン同期処理
   - 通知管理

3. **コンテンツスクリプト**
   - テキスト選択の監視
   - コンテキストメニュー統合
   - ページコンテンツの抽出

4. **ストレージ**
   - 設定の保存
   - タスクキャッシュ
   - 認証情報の安全な保存

### データフロー

1. ユーザーがタスクを作成
2. タスクデータをFirebase Firestoreに直接追加
3. 認証はFirebase Auth経由
4. オフライン時はローカルストレージにキャッシュ

## ユーザーインターフェース

### ポップアップ

![ポップアップUI（イメージ）](https://via.placeholder.com/300x400)

* **ヘッダー**: TaskVisionロゴ、ログイン状態
* **タスク作成フォーム**:
  * タイトル欄（ページタイトルがデフォルト）
  * 説明欄（選択テキストがある場合は自動挿入）
  * URL情報（自動挿入、編集可）
  * 期限設定（オプション）
  * ブロック割り当て（オプション）
* **アクション**:
  * 「タスクを作成」ボタン
  * 「キャンセル」ボタン

### コンテキストメニュー

* 「選択テキストをTaskVisionタスクに追加」
* 「現在のページをTaskVisionに保存」

### 設定ページ

* アカウント連携設定
* デフォルトのタスク設定
* ショートカットキー設定
* 同期設定

## 開発計画

### フェーズ1: 基本機能（推定期間: 3週間）

- [x] プロジェクト構造とビルド設定
- [ ] マニフェストファイル作成
- [ ] 基本的なポップアップUI
- [ ] ページ情報の取得機能
- [ ] Firebase認証連携

### フェーズ2: 機能拡張（推定期間: 2週間）

- [ ] テキスト選択とコンテキストメニュー
- [ ] タスク作成と保存機能
- [ ] エラーハンドリング
- [ ] 設定ページ

### フェーズ3: 高度な機能と洗練（推定期間: 2週間）

- [ ] オフラインサポート
- [ ] ショートカットキー
- [ ] UIの洗練
- [ ] アニメーションと視覚的フィードバック

### フェーズ4: テストとリリース（推定期間: 1週間）

- [ ] 単体テスト
- [ ] エンドツーエンドテスト
- [ ] ユーザーフィードバック収集
- [ ] Chrome Web Storeへの公開準備

## セキュリティ考慮事項

1. **認証情報の安全な保存**
   - Chrome Storageの暗号化APIを使用
   - センシティブな情報はセッション中のみ保持

2. **データのプライバシー**
   - 最小限のパーミッション要求
   - ユーザーデータの使用目的を明示

3. **通信の安全性**
   - すべての通信をHTTPS経由で実行
   - Firebase SDKの安全な使用

## テスト計画

1. **単体テスト**
   - Jest/React Testing Libraryによるコンポーネントテスト
   - バックグラウンドロジックのテスト

2. **統合テスト**
   - Chrome拡張機能APIとの統合テスト
   - Firebase連携のテスト

3. **エンドツーエンドテスト**
   - 実際のブラウザ環境での動作確認
   - 異なるウェブサイトでのテスト

## 配布計画

1. Chrome Web Storeへの公開
2. バージョン管理と更新メカニズム
3. ユーザーフィードバックの収集チャネル

## 今後の拡張予定

1. **AI支援タスク生成**
   - ページコンテンツの分析によるタスク提案
   - 重要情報の自動抽出

2. **高度なカスタマイズ**
   - カスタムテンプレート
   - ウェブサイト固有の設定

3. **複数ブラウザ対応**
   - Firefox版
   - Edge版

## 開発リソース

- [Chrome Extension Documentation](https://developer.chrome.com/docs/extensions/)
- [Firebase JavaScript SDK](https://firebase.google.com/docs/web/setup)
- [React Chrome Extension Boilerplate](https://github.com/lxieyang/chrome-extension-boilerplate-react)
